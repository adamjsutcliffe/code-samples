using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using Peak.Speedoku.Scripts.Common;
using Peak.Speedoku.Scripts.Autogenerated;
using System;

namespace Peak.Speedoku.Scripts.ScenesLogic
{
    public class PauseMenuActivator : SceneActivationBehaviour<PauseMenuActivator> 
    {
        [SerializeField] private GameObject SoundButtonCross;
        [SerializeField] private GameObject MusicButtonCross;
        public event Action GameQuit;
        public event Action GameResumed;

        public override void Initialize()
        {
            base.Initialize();
        }

        public override void Show(bool animated = false)
        {
            SoundButtonCross.SetActive(!LocalisationController.Instance.IsSoundEnabled);
            MusicButtonCross.SetActive(!LocalisationController.Instance.IsMusicEnabled);
            base.Show(animated);
        }

        public override void Hide()
        {
            base.Hide();
        }

        //public override void SetButtonsEnabled(bool isEnabled)
        //{
            //base.SetButtonsEnabled(isEnabled);
        //}

        public void ResumeButtonHandler()
        {
            print("RESUME");
            InterfaceController.Instance.Hide(GameWindow.PauseMenu);
            LocalisationController.Instance.PlayAudioClip(Settings.Autogenerated.SoundSettingsKey.PopupSound);
            GameResumed?.Invoke();
        }

        public void HelpButtonHandler()
        {
            print("HELP");
            InterfaceController.Instance.Show(GameWindow.TutorialPopup, true);
            LocalisationController.Instance.PlayAudioClip(Settings.Autogenerated.SoundSettingsKey.PopupSound);
        }

        public void QuitButtonHandler()
        {
            print("QUIT");
            GameQuit?.Invoke();
            InterfaceController.Instance.Hide(GameWindow.PauseMenu);
            LocalisationController.Instance.PlayAudioClip(Settings.Autogenerated.SoundSettingsKey.PopupSound);
            SceneActivationBehaviour<MainMenuActivator>.Instance.QuitButtonHandler();
        }

        public void SoundButtonPressed()
        {
            LocalisationController.Instance.ToggleSfx(true);
            SoundButtonCross.SetActive(!LocalisationController.Instance.IsSoundEnabled);
        }

        public void MusicButtonPressed()
        {
            LocalisationController.Instance.ToggleMusic(true);
            MusicButtonCross.SetActive(!LocalisationController.Instance.IsMusicEnabled);
        }
    }
}
